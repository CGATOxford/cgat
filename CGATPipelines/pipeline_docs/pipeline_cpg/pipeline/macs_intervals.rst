==============
MACS Intervals
==============

The following table presents the number of intervals per dataset after filtering with fold change >=10:

.. report:: macs_intervals.IntervalsSummaryFiltered
   :render: table

   MACS interval summary

Interval Length
===============

The following plot shows the distribution of interval length for each dataset.

.. report:: macs_intervals.IntervalLengths
   :render: line-plot
   :transform: histogram
   :groupby: all
   :logscale: x
   :tf-aggregate: normalized-total
   :as-lines:

   Distribution of interval lengths


Interval Coverage
=================

Average Coverage
----------------

The following plot shows the distribution of average interval coverage for each dataset.
The average coverage is the average number of reads covering each base the interval.

.. report:: macs_intervals.IntervalAverageValues
   :render: line-plot
   :transform: histogram
   :groupby: all
   :tf-range: 0,50
   :tf-aggregate: normalized-total,reverse-cumulative
   :as-lines:

   Distribution of the average number of reads
   matching to bins within an interval.

Maximum Coverage
----------------

The following plot shows the maximum interval coverage for each dataset.
The maximum coverage is the maximum number of reads falling into the
bins that constitute an interval. The interval peak is the position with the maximum
number of reads.

.. report:: macs_intervals.IntervalPeakValues
   :render: line-plot
   :transform: histogram
   :groupby: all
   :tf-range: 0,100
   :tf-aggregate: normalized-total,reverse-cumulative
   :as-lines:

   Distribution of the number of reads at the peak within an interval.
   The proportion of intervals of a certain peak value or more.

Interval Fold Change
====================

The following plot shows the distribution of the fold change for each dataset.
The fold change is the enrichment of reads within the interval compared to the input sample or to local background.

.. report:: macs_intervals.IntervalFoldChange
   :render: line-plot
   :transform: histogram
   :groupby: all
   :tf-range: 0,50
   :tf-aggregate: normalized-total,reverse-cumulative
   :as-lines:

   Distribution of the fold change per interval


CpG Density
===========

The following plot shows the distribution of CpG density for each set.

.. report:: macs_intervals.CpGDensity
   :render: line-plot
   :transform: histogram
   :groupby: all
   :as-lines:

   Distribution of CpG density


CpG Observed/Expected
=====================

The following plots show the distribution of observed/expected CpGs for each dataset.
The expected number of CpG dinucleotides was calculated as the length of the sequence divided by the number of 
possible dinucleotides as in Takai and Jones PNAS (2002). 
The control dataset was generated by taking an interval of the same size 10kb upstream of the CpG island.

.. report:: macs_intervals.CpGObsExp1
   :render: line-plot
   :transform: histogram
   :groupby: all
   :as-lines:

   Distribution observed/expected CpGs (expected = length/16)


The following plots show the distribution of observed/expected CpGs for each set.
The expected number of CpG dinucleotides was calculated as the product of the number of C and G nucleotides 
in the interval divided by the interval length as in Emboss cpgplot.
The control dataset was generated by taking an interval of the same size 10kb upstream of the CpG island.

.. report:: macs_intervals.CpGObsExp2
   :render: line-plot
   :transform: histogram
   :groupby: all
   :xrange: 0,2
   :as-lines:

   Distribution observed/expected CpGs (expected = nC*nG/length)


GC Content
==========

The following plot shows the distribution of GC content for each set.

.. report:: macs_intervals.GCContent
   :render: line-plot
   :transform: histogram
   :groupby: all
   :as-lines:

   Distribution of GC content

Peak location
=============

The following plot shows the distribution of the peak location within
an interval for each set, i.e. is it on the sides or the middle
of an interval. Note that this counting does not take into account
strandedness.

.. report:: macs_intervals.PeakLocation
   :render: line-plot
   :transform: histogram
   :groupby: all
   :tf-aggregate: normalized-total
   :as-lines:
  
   Distance of peak towards start/end of interval normalized
   by the size of the interval.

The following plot shows the distribution of the peak distance within
an interval for each set, i.e. is it on the sides or the middle
of an interval. Note that this counting does not take into account
strandedness.

.. report:: macs_intervals.PeakDistance
   :render: line-plot
   :transform: histogram
   :groupby: all
   :logscale: x
   :tf-aggregate: normalized-total
   :as-lines:
  
   Distance of peak towards start/end of interval


